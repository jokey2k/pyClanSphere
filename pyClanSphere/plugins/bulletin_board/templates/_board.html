{% macro addtool(starttag, endtag, icon) %}<a href="javascript:void(0);" onClick="pyClanSphere.insertText('text','{{ starttag }}','[/{{ endtag }}]')"><img src="{{ shared_url('core::editicons/'+icon) }}" width="24" height="24" alt="{{ tag }}"></a>{% endmacro %}

{% macro addsimpletool(tag, icon) %}{{ addtool('[' + tag + ']',tag,icon) }}{% endmacro %}

{% macro author_link(author) %}
{% if author.is_somebody %}
<a href="#">{{ author.display_name }}</a>
{% else %}
{{ author.display_name }}
{% endif %}
{% endmacro %}

{% macro topic_name_link(topic) %}
<a href="{{ url_for('board/topic_detail', topic_id=topic.id) }}">{{ topic.name }}</a>
{% endmacro %}

{% macro lastpost_link(post) %}
<a href="{{ url_for('board/post_find', post_id=post.id) }}"><img src="{{ shared_url('core::editicons/postlink.gif') }}" width="12" height="12">{{ post.date|fancydatetimeformat|capitalize }}</a>
{% endmacro %}

{% macro render_post_form(form) %}
<div id="newpost">
  <a name="post-edit"></a>
  <table width="100%" style="" class="boardpost">
  {# we use render rather than just calling because we want
       our own error reporting inside the box #}
  {% call form.render() %}
  <tr>
    <th class="headline" colspan="3">{{ _("New Post") }}</th>
  </tr>
  {% if form.errors %}
  <tr>
    <td class="label">{{ _("Error") }}</td>
    <td colspan="2">{{ form.errors.as_ul()|safe }}</td>
  </tr>
  {% endif %}
  {% if not request.user.is_somebody %}
  <tr>
    <td class="label">{{ form.yourname.label() }}</td>
    <td colspan="2">{{ form.yourname() }}</td>
  </tr>
  {% endif %}
  {% if form.title %}
  <tr>
    <td class="label">{{ form.title.label() }}</td>
    <td colspan="2">{{ form.title() }}</td>
  </tr>
  {% endif %}
  <tr>
    <td class="label"></td>
    <td colspan="2">{% for tool in ['b','u','i','s','link','size','color','center'] %}{{ addsimpletool(tool,tool+".png") }}{% endfor %}{{ addtool('[list][*]','list','list.png') }}</td>
  <tr>
    <td class="label"><img src="{{ shared_url('core::editicons/text.gif') }}" width="16" height="16" alt="{{ tag }}">{{ form.text.label() }}</td>
    <td align="center">{{ form.text(cols=100) }}</td>
    <td width="100px">{{ smileylist('text')|safe }}</td>
  </tr>
  {% if form.captcha %}
  <tr>
    <td colspan="3" align="center">{{ form.captcha }}</td>
  </tr>
  {% endif %}
  <tr>
    <td colspan="3" align="center"><input type="submit" value="{{ _("Submit") }}"></td>
  </tr>
  {% endcall %}
  </table>
</div>
{% endmacro %}