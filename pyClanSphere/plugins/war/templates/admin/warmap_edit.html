{% extends "admin/layout.html" %}
{% from "admin/_form_helpers.html" import render_actions %}
{% macro render_formmultibox(fields, boxlabel, class, toggleable=true, collapsed=true, disabled=false) %}
  <div class="formbox{{ " " + class if class }}{{ " toggleable" if toggleable
    }}{{ " collapsed" if collapsed and toggleable }}">
    <h3>{{ boxlabel }}</h3>
    <table>
    {% for field in fields %}
    <tr><td nowrap>{{ field.label() }}</td><td width="100%">{{ caller(disabled=disabled, class='clearMeOnFocus') if caller else field(disabled=disabled, class='clearMeOnFocus') }}{%- if field.help_text %}<br><span class="explanation">{{ field.help_text }}</span>{% endif %}</td></tr>
    {% endfor %}
    </table>
  </div>
{% endmacro %}
{% block title %}{{ _('New warmap') if form.new else _('Edit warmap') }}{% endblock %}
{% block contents %}
  <h1>{{ self.title() }}</h1>
  {% call form(enctype="multipart/form-data") %}

    {{ render_formmultibox([form.mapname, form.squad],
                           _("Map basics"), toggleable=false) }}
      <div class="formbox toggleable {{ 'collapsed' if form.warmap.has_file }}">
        <h3>{{ _("Upload Mapfile") }}</h3>
        <table>
        <tr>
          <td nowrap>{{ form.readmapname.label() }}:</td><td width="100%">{{ form.readmapname() }}</td>
        </tr>
        <tr>
          <td nowrap>{{ _("Map file uploaded before") }}:</td><td width="100%">{{ _("Yes") if form.warmap.has_file else _("No") }}</td>
        </tr>
        <tr><td colspan="2"><input type="file" name="mapfile"></td></tr>
        </table>
      </div>
    {{ render_actions(form) }}
  {% endcall %}
{% endblock %}
